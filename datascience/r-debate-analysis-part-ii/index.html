<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>More republican debate analysis with R | En El Margen</title>
  <meta name="viewport" content="width=device-width">


  <!-- syntax highlighting CSS -->
  <link rel="stylesheet" href="/css/syntax.css">

  <!-- CSS -->
  <link rel="stylesheet" href="/css/reset.css">
  <link rel="stylesheet" href="/css/main.css">
  <!-- <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet"> -->


  <!-- Fonts -->
  <link href='http://fonts.googleapis.com/css?family=Bitter:400,700,400italic|Open+Sans:400italic,600italic,400,600' rel='stylesheet' type='text/css'>
  
  
  <link rel="stylesheet" href="/css/post.css">
  

</head>
<body>
  <header style="background-image: url(/images/cover.jpg);">
  <div class="container post-container">
    <a href="/" class="home_button"></a>
    <div class="inner-container">
      <ul class="meta">
        <li>
        <p style="color:white">Publicado: 07 Jan 2016</p>
        </li>
        <li>
            <p style="color:white">Archivado en: r-english, datascience</p>
        </li>
      </ul>      
    </div>
    <ul class="pagination">
      
        <li class="previous">
          <a href="/economia/Conocer-Mexico">
            Previous
          </a>
        </li>
      
      
    </ul>
  </div>
</header>

<article>
  <div class="container">
          <h1>More republican debate analysis with R</h1>
          <br></br>
    <p>A few weeks late, here is a follow-up analysis using <em>R</em>, of the transcript of the latest Republican primary debate held at Las Vegas, Nevada.</p>

<p>Like the previous post, it should be interesting to see some word-clouds and some trends from the front-runners (and <em>of course</em>, Donald Trump).</p>

<h2 id="getting-and-cleaning-the-data">Getting and cleaning the data</h2>

<p>As in the last post, we’re going to import the data and clean with a function that was <a href="http://enelmargen.org/datascience/republican-debates/index.html">nicely improved by Alan Jordan</a>:</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># some packages for scraping and cleaning the data</span>
<span class="kn">library</span><span class="p">(</span>rvest<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>plyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>stringi<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>magrittr<span class="p">)</span>

<span class="c1"># function to partially separate and clean into a data.frame a debate from the presidency project</span>
MakeDebateDF<span class="o">&lt;-</span><span class="kr">function</span><span class="p">(</span>df<span class="p">){</span>
  newdf <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>
    person <span class="o">=</span> <span class="kp">apply</span><span class="p">(</span>df<span class="p">,</span> 
                   MARGIN <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                   <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>
                     stri_extract_first_regex<span class="p">(</span>x<span class="p">,</span> 
                                              <span class="s">&quot;[A-Z&#39;-]+(?=(:\\s))&quot;</span><span class="p">)</span>
                   <span class="p">}),</span>
    message <span class="o">=</span> <span class="kp">apply</span><span class="p">(</span>df<span class="p">,</span> 
                    MARGIN <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                    <span class="kr">function</span><span class="p">(</span>x<span class="p">){</span>
                      stri_replace_first_regex<span class="p">(</span>x<span class="p">,</span>
                                               <span class="s">&quot;[A-Z&#39;-]+:\\s+&quot;</span><span class="p">,</span> 
                                               <span class="s">&quot;&quot;</span><span class="p">)</span>
                    <span class="p">}),</span>
    stringsAsFactors<span class="o">=</span><span class="kc">FALSE</span>
  <span class="p">)</span>
  <span class="kr">for</span> <span class="p">(</span>j <span class="kr">in</span> <span class="m">2</span><span class="o">:</span><span class="kp">nrow</span><span class="p">(</span>newdf<span class="p">))</span> <span class="p">{</span> 
  <span class="kr">if</span> <span class="p">(</span><span class="kp">is.na</span><span class="p">(</span>newdf<span class="p">[</span>j<span class="p">,</span><span class="s">&#39;person&#39;</span><span class="p">]))</span> 
		<span class="p">{</span>newdf<span class="p">[</span>j<span class="p">,</span><span class="s">&#39;person&#39;</span><span class="p">]</span> <span class="o">&lt;-</span>  newdf<span class="p">[(</span>j<span class="m">-1</span><span class="p">),</span><span class="s">&#39;person&#39;</span><span class="p">]</span> <span class="p">}</span>
	<span class="p">}</span>

  <span class="kr">return</span><span class="p">(</span>newdf<span class="p">)</span>
<span class="p">}</span></code></pre></div>

<p>This time i’m only downloading one debate, and joining with the last four I had parsed…</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Importing debates --- </span>
<span class="c1"># url for all debates</span>
url <span class="o">&lt;-</span> <span class="s">&quot;http://www.presidency.ucsb.edu/ws/index.php?pid=&quot;</span>

<span class="c1">### -------- debate in Las Vegas, Nevada (fifth debate)</span>
lasvegas <span class="o">&lt;-</span> <span class="s">&quot;111177&quot;</span>

debate_v <span class="o">&lt;-</span> read_html<span class="p">(</span><span class="kp">paste0</span><span class="p">(</span><span class="kp">url</span><span class="p">,</span> lasvegas<span class="p">))</span> <span class="o">%&gt;%</span> 
  html_nodes<span class="p">(</span><span class="s">&quot;p&quot;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  html_text<span class="p">()</span>

debate_v <span class="o">&lt;-</span> ldply<span class="p">(</span>debate_v<span class="p">,</span> <span class="kp">rbind</span><span class="p">)</span>
debate_v <span class="o">&lt;-</span> MakeDebateDF<span class="p">(</span>debate_v<span class="p">)</span></code></pre></div>

<h2 id="analyzing">Analyzing</h2>
<p>Let’s join this data with the previous debates and see some stats and wordclouds…</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># the last 4 debates were stored in &quot;all_debates&quot; object...</span>
all_debates <span class="o">&lt;-</span> <span class="kp">rbind</span><span class="p">(</span>all_debates<span class="p">,</span> 
                     debate_v<span class="p">)</span></code></pre></div>

<p>Because he’s the most interesting to watch, let’s see what Trump says overall and in this debate…</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="c1"># this is for order_axis and theme_eem</span>
<span class="c1"># it can be downloaded using </span>
<span class="c1"># devtools::install_github(&quot;eflores89/eem&quot;)</span>
<span class="kn">library</span><span class="p">(</span>eem<span class="p">)</span>
<span class="c1"># all debates</span>
trump_words <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span><span class="kp">subset</span><span class="p">(</span>all_debates<span class="p">,</span> person <span class="o">==</span> <span class="s">&quot;TRUMP&quot;</span><span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                    <span class="m">1</span><span class="p">,</span>
                    <span class="kp">paste</span><span class="p">)</span>
<span class="c1"># cloud</span>
<span class="c1"># function taken from: </span>
<span class="c1"># http://www.sthda.com/english/wiki/word-cloud-generator-in-r-one-killer-function-to-do-everything-you-need</span>
trump_cloud <span class="o">&lt;-</span> rquery.wordcloud<span class="p">(</span>trump_words<span class="p">,</span> 
    <span class="s">&quot;text&quot;</span><span class="p">,</span> 
    max.words <span class="o">=</span> <span class="m">300</span><span class="p">,</span>
    excludeWords <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;going&quot;</span><span class="p">,</span><span class="s">&quot;and&quot;</span><span class="p">,</span>
                    <span class="s">&quot;applause&quot;</span><span class="p">,</span><span class="s">&quot;get&quot;</span><span class="p">,</span>
                    <span class="s">&quot;got&quot;</span><span class="p">,</span><span class="s">&quot;let&quot;</span><span class="p">))</span>

trump_freq <span class="o">&lt;-</span> trump_cloud<span class="o">$</span>freqTable

<span class="c1"># debate in Las Vegas</span>
trump_words_l <span class="o">&lt;-</span> <span class="kp">apply</span><span class="p">(</span><span class="kp">subset</span><span class="p">(</span>debate_v<span class="p">,</span> person <span class="o">==</span> <span class="s">&quot;TRUMP&quot;</span><span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                    <span class="m">1</span><span class="p">,</span>
                    <span class="kp">paste</span><span class="p">)</span>
trump_cloud_l <span class="o">&lt;-</span> rquery.wordcloud<span class="p">(</span>trump_words_l<span class="p">,</span> 
    <span class="s">&quot;text&quot;</span><span class="p">,</span> 
    max.words <span class="o">=</span> <span class="m">300</span><span class="p">,</span>
    excludeWords <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;going&quot;</span><span class="p">,</span><span class="s">&quot;and&quot;</span><span class="p">,</span>
                    <span class="s">&quot;applause&quot;</span><span class="p">,</span><span class="s">&quot;get&quot;</span><span class="p">,</span>
                    <span class="s">&quot;got&quot;</span><span class="p">,</span><span class="s">&quot;let&quot;</span><span class="p">))</span>

trump_freq_l <span class="o">&lt;-</span> trump_cloud_l<span class="o">$</span>freqTable</code></pre></div>

<h2 id="overall-word-cloud">Overall word-cloud</h2>

<p><img src="/images/posts/trump_cloud2.png" alt="Donald Trump all debates wordcloud" /></p>

<h2 id="las-vegas">Las Vegas</h2>

<p><img src="/images/posts/trump_cloud_lv.png" alt="Donald Trump las vegas debate word cloud" /></p>

<h2 id="shifts-in-speech">Shifts in speech</h2>

<p>Of course, over the same five debates, topics have shifted tremendously both among the contenders and Trump.</p>

<p>For example, let’s see what the most spoken words were by debate…</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># using previous data for each debate....</span>
debate_words_h <span class="o">&lt;-</span> rquery.wordcloud<span class="p">(</span>x <span class="o">=</span> debate_h<span class="o">$</span><span class="kp">message</span><span class="p">)</span> <span class="c1">#ohio, 1st</span>
  <span class="c1"># just the frequency table...</span>
  <span class="c1"># a bit lazy to do myself!</span>
  debate_words_h <span class="o">&lt;-</span> debate_words_h<span class="o">$</span>freq <span class="o">%&gt;%</span> mutate<span class="p">(</span><span class="s">&quot;Debate&quot;</span> <span class="o">=</span> <span class="s">&quot;Ohio&quot;</span><span class="p">)</span>
debate_words_c <span class="o">&lt;-</span> rquery.wordcloud<span class="p">(</span>x <span class="o">=</span> debate_c<span class="o">$</span><span class="kp">message</span><span class="p">)</span> <span class="c1">#cali, 2nd</span>
  debate_words_c <span class="o">&lt;-</span> debate_words_c<span class="o">$</span>freq <span class="o">%&gt;%</span> mutate<span class="p">(</span><span class="s">&quot;Debate&quot;</span> <span class="o">=</span> <span class="s">&quot;California&quot;</span><span class="p">)</span>
debate_words_b <span class="o">&lt;-</span> rquery.wordcloud<span class="p">(</span>x <span class="o">=</span> debate_b<span class="o">$</span><span class="kp">message</span><span class="p">)</span> <span class="c1">#boulder, 3rd</span>
  debate_words_b <span class="o">&lt;-</span> debate_words_b<span class="o">$</span>freq <span class="o">%&gt;%</span> mutate<span class="p">(</span><span class="s">&quot;Debate&quot;</span> <span class="o">=</span> <span class="s">&quot;Boulder&quot;</span><span class="p">)</span>
debate_words_w <span class="o">&lt;-</span> rquery.wordcloud<span class="p">(</span>x <span class="o">=</span> debate_w<span class="o">$</span><span class="kp">message</span><span class="p">)</span> <span class="c1">#wisc, 4th</span>
  debate_words_w <span class="o">&lt;-</span> debate_words_w<span class="o">$</span>freq <span class="o">%&gt;%</span> mutate<span class="p">(</span><span class="s">&quot;Debate&quot;</span> <span class="o">=</span> <span class="s">&quot;Wisconsin&quot;</span><span class="p">)</span>
debate_words_v <span class="o">&lt;-</span> rquery.wordcloud<span class="p">(</span>x <span class="o">=</span> debate_v<span class="o">$</span><span class="kp">message</span><span class="p">)</span> <span class="c1">#vegas, 5th</span>
  debate_words_v <span class="o">&lt;-</span> debate_words_v<span class="o">$</span>freq <span class="o">%&gt;%</span> mutate<span class="p">(</span><span class="s">&quot;Debate&quot;</span> <span class="o">=</span> <span class="s">&quot;LasVegas&quot;</span><span class="p">)</span>

<span class="c1"># join all</span>
all_debate_words <span class="o">&lt;-</span> <span class="kp">rbind.data.frame</span><span class="p">(</span>debate_words_h<span class="p">,</span> debate_words_c<span class="p">)</span> 
all_debate_words <span class="o">&lt;-</span> <span class="kp">rbind.data.frame</span><span class="p">(</span>all_debate_words<span class="p">,</span> debate_words_b<span class="p">)</span> 
all_debate_words <span class="o">&lt;-</span> <span class="kp">rbind.data.frame</span><span class="p">(</span>all_debate_words<span class="p">,</span> debate_words_w<span class="p">)</span> 
all_debate_words <span class="o">&lt;-</span> <span class="kp">rbind.data.frame</span><span class="p">(</span>all_debate_words<span class="p">,</span> debate_words_v<span class="p">)</span> 

<span class="c1"># graph with some interesting words...</span>
interesting_words <span class="o">&lt;-</span> <span class="kp">subset</span><span class="p">(</span>all_debate_words<span class="p">,</span> word <span class="o">%in%</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;government&quot;</span><span class="p">,</span>
                                              <span class="s">&quot;isis&quot;</span><span class="p">,</span><span class="s">&quot;president&quot;</span><span class="p">,</span><span class="s">&quot;senator&quot;</span><span class="p">,</span>
                                              <span class="s">&quot;money&quot;</span><span class="p">,</span> <span class="s">&quot;jobs&quot;</span><span class="p">,</span> <span class="s">&quot;tax&quot;</span><span class="p">,</span> <span class="s">&quot;obama&quot;</span><span class="p">,</span>
                                              <span class="s">&quot;clinton&quot;</span><span class="p">,</span> <span class="s">&quot;america&quot;</span><span class="p">))</span>

interesting_words<span class="o">$</span>Debate <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>interesting_words<span class="o">$</span>Debate<span class="p">,</span> 
                          levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;Ohio&quot;</span><span class="p">,</span><span class="s">&quot;California&quot;</span><span class="p">,</span>
                                     <span class="s">&quot;Boulder&quot;</span><span class="p">,</span><span class="s">&quot;Wisconsin&quot;</span><span class="p">,</span>
                                     <span class="s">&quot;LasVegas&quot;</span><span class="p">))</span>

ggplot<span class="p">(</span>data <span class="o">=</span> interesting_words<span class="p">,</span> 
        aes<span class="p">(</span>x <span class="o">=</span> Debate<span class="p">,</span> 
            y <span class="o">=</span> freq<span class="p">,</span> 
            group <span class="o">=</span> word<span class="p">))</span> <span class="o">+</span> 
        geom_line<span class="p">(</span>aes<span class="p">(</span>colour <span class="o">=</span> word<span class="p">))</span> <span class="o">+</span>
        theme_eem<span class="p">()</span> <span class="o">+</span>
        scale_colour_eem<span class="p">(</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span> 
        labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Debate&quot;</span><span class="p">,</span> 
             y <span class="o">=</span> <span class="s">&quot;Frequency&quot;</span><span class="p">,</span> 
             title <span class="o">=</span> <span class="s">&quot;Shifts in speech&quot;</span><span class="p">)</span></code></pre></div>

<p>Apparently, “tax” is out: it wasn’t even mentioned this past debate, in contrast with the increasingly present “isis”. “Clinton” and “obama” are a constant:</p>

<p><img src="/images/posts/shifts_p2.png" alt="shifts in speech republican debates" /></p>

<h2 id="aggregate-stats">Aggregate stats</h2>

<p>Now lets see some aggregate stats by contender.</p>

<blockquote>
  <p>This function is a bit confusing and/or unnecesary, I’ll probably find a better way to do this in the future…</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r">UnlistAndExtractInfo <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>candidate<span class="p">){</span>
<span class="c1"># this function is not general - it only applies to these particular debates...</span>
<span class="c1"># all the debates must be named the same in the parent env.</span>
<span class="c1"># for example: debate_h ...</span>

allwords_1 <span class="o">&lt;-</span> <span class="kp">tolower</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>
              stri_extract_all_words<span class="p">(</span>
              <span class="kp">apply</span><span class="p">(</span>
              <span class="kp">subset</span><span class="p">(</span>debate_h<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                    <span class="m">1</span><span class="p">,</span>
                    <span class="kp">paste</span><span class="p">))))</span>
allwords_2 <span class="o">&lt;-</span> <span class="kp">tolower</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>
              stri_extract_all_words<span class="p">(</span>
              <span class="kp">apply</span><span class="p">(</span>
              <span class="kp">subset</span><span class="p">(</span>debate_c<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                    <span class="m">1</span><span class="p">,</span>
                    <span class="kp">paste</span><span class="p">))))</span>
allwords_3 <span class="o">&lt;-</span> <span class="kp">tolower</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>
              stri_extract_all_words<span class="p">(</span>
              <span class="kp">apply</span><span class="p">(</span>
              <span class="kp">subset</span><span class="p">(</span>debate_b<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                    <span class="m">1</span><span class="p">,</span>
                    <span class="kp">paste</span><span class="p">))))</span>
allwords_4 <span class="o">&lt;-</span> <span class="kp">tolower</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>
              stri_extract_all_words<span class="p">(</span>
              <span class="kp">apply</span><span class="p">(</span>
              <span class="kp">subset</span><span class="p">(</span>debate_w<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                    <span class="m">1</span><span class="p">,</span>
                    <span class="kp">paste</span><span class="p">))))</span>
allwords_5 <span class="o">&lt;-</span> <span class="kp">tolower</span><span class="p">(</span><span class="kp">unlist</span><span class="p">(</span>
              stri_extract_all_words<span class="p">(</span>
              <span class="kp">apply</span><span class="p">(</span>
              <span class="kp">subset</span><span class="p">(</span>debate_v<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                    <span class="m">1</span><span class="p">,</span>
                    <span class="kp">paste</span><span class="p">))))</span>
df_insights <span class="o">&lt;-</span> <span class="kt">data.frame</span><span class="p">(</span>
debate <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;Ohio&quot;</span><span class="p">,</span> <span class="s">&quot;California&quot;</span><span class="p">,</span> <span class="s">&quot;Colorado&quot;</span><span class="p">,</span> <span class="s">&quot;Wisconsin&quot;</span><span class="p">,</span><span class="s">&quot;Vegas&quot;</span><span class="p">),</span>
average_intervention <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kp">mean</span><span class="p">(</span>stri_count_words<span class="p">(</span>
                        <span class="kp">apply</span><span class="p">(</span>
                          <span class="kp">subset</span><span class="p">(</span>debate_h<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                                  <span class="m">1</span><span class="p">,</span>
                        <span class="kp">paste</span><span class="p">))),</span>
                        <span class="kp">mean</span><span class="p">(</span>stri_count_words<span class="p">(</span>
                        <span class="kp">apply</span><span class="p">(</span>
                          <span class="kp">subset</span><span class="p">(</span>debate_c<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                                  <span class="m">1</span><span class="p">,</span>
                        <span class="kp">paste</span><span class="p">))),</span>
                        <span class="kp">mean</span><span class="p">(</span>stri_count_words<span class="p">(</span>
                        <span class="kp">apply</span><span class="p">(</span>
                          <span class="kp">subset</span><span class="p">(</span>debate_b<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                                  <span class="m">1</span><span class="p">,</span>
                        <span class="kp">paste</span><span class="p">))),</span>
                        <span class="kp">mean</span><span class="p">(</span>stri_count_words<span class="p">(</span>
                        <span class="kp">apply</span><span class="p">(</span>
                          <span class="kp">subset</span><span class="p">(</span>debate_w<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                                  <span class="m">1</span><span class="p">,</span>
                        <span class="kp">paste</span><span class="p">))),</span>
                        <span class="kp">mean</span><span class="p">(</span>stri_count_words<span class="p">(</span>
                        <span class="kp">apply</span><span class="p">(</span>
                          <span class="kp">subset</span><span class="p">(</span>debate_c<span class="p">,</span> person <span class="o">==</span> candidate<span class="p">)[</span><span class="s">&#39;message&#39;</span><span class="p">],</span>
                                  <span class="m">1</span><span class="p">,</span>
                        <span class="kp">paste</span><span class="p">)))</span>
                        <span class="p">),</span>
words_total <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kp">length</span><span class="p">(</span>allwords_1<span class="p">),</span>
                <span class="kp">length</span><span class="p">(</span>allwords_2<span class="p">),</span>
                <span class="kp">length</span><span class="p">(</span>allwords_3<span class="p">),</span>
                <span class="kp">length</span><span class="p">(</span>allwords_4<span class="p">),</span>
                <span class="kp">length</span><span class="p">(</span>allwords_5<span class="p">)),</span>
words_unique <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_1<span class="p">)),</span>
                 <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_2<span class="p">)),</span>
                 <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_3<span class="p">)),</span>
                 <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_4<span class="p">)),</span>
                 <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_5<span class="p">))</span>
                 <span class="p">),</span>
words_repeated_fromfirst <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="kp">sum</span><span class="p">(</span>allwords_2 <span class="o">%in%</span> allwords_1<span class="p">),</span> 
                            <span class="kp">sum</span><span class="p">(</span>allwords_3 <span class="o">%in%</span> allwords_1<span class="p">),</span>
                            <span class="kp">sum</span><span class="p">(</span>allwords_4 <span class="o">%in%</span> allwords_1<span class="p">),</span>
                            <span class="kp">sum</span><span class="p">(</span>allwords_5 <span class="o">%in%</span> allwords_1<span class="p">)),</span>
unique_words_repeated_fromfirst <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_2<span class="p">[</span>allwords_2 <span class="o">%in%</span> allwords_1<span class="p">])),</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_3<span class="p">[</span>allwords_3 <span class="o">%in%</span> allwords_1<span class="p">])),</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_4<span class="p">[</span>allwords_4 <span class="o">%in%</span> allwords_1<span class="p">])),</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_5<span class="p">[</span>allwords_5 <span class="o">%in%</span> allwords_1<span class="p">]))</span>
                            <span class="p">),</span>
words_repeated_fromsecond <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> 
                            <span class="kp">sum</span><span class="p">(</span>allwords_3 <span class="o">%in%</span> allwords_2<span class="p">),</span>
                            <span class="kp">sum</span><span class="p">(</span>allwords_4 <span class="o">%in%</span> allwords_2<span class="p">),</span>
                            <span class="kp">sum</span><span class="p">(</span>allwords_5 <span class="o">%in%</span> allwords_2<span class="p">)),</span>
unique_words_repeated_fromsecond <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_3<span class="p">[</span>allwords_3 <span class="o">%in%</span> allwords_2<span class="p">])),</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_4<span class="p">[</span>allwords_4 <span class="o">%in%</span> allwords_2<span class="p">])),</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_5<span class="p">[</span>allwords_5 <span class="o">%in%</span> allwords_2<span class="p">]))</span>
                            <span class="p">),</span>
words_repeated_fromthird <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span>
                            <span class="kp">sum</span><span class="p">(</span>allwords_4 <span class="o">%in%</span> allwords_3<span class="p">),</span>
                            <span class="kp">sum</span><span class="p">(</span>allwords_5 <span class="o">%in%</span> allwords_3<span class="p">)),</span>
unique_words_repeated_fromthird <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_4<span class="p">[</span>allwords_4 <span class="o">%in%</span> allwords_3<span class="p">])),</span>
                            <span class="kp">length</span><span class="p">(</span><span class="kp">unique</span><span class="p">(</span>allwords_5<span class="p">[</span>allwords_5 <span class="o">%in%</span> allwords_3<span class="p">]))</span>
                            <span class="p">)</span>
<span class="p">,</span> stringsAsFactors <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
<span class="kr">return</span><span class="p">(</span>df_insights<span class="p">)</span>
<span class="p">}</span>

<span class="c1"># going to create a data frame with all the counts from the top candidates...</span>
candidates <span class="o">&lt;-</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;TRUMP&quot;</span><span class="p">,</span><span class="s">&quot;CARSON&quot;</span><span class="p">,</span><span class="s">&quot;RUBIO&quot;</span><span class="p">,</span>
                <span class="s">&quot;KASICH&quot;</span><span class="p">,</span><span class="s">&quot;CRUZ&quot;</span><span class="p">,</span><span class="s">&quot;BUSH&quot;</span><span class="p">,</span>
                <span class="s">&quot;FIORINA&quot;</span><span class="p">,</span><span class="s">&quot;PAUL&quot;</span><span class="p">,</span><span class="s">&quot;CHRISTIE&quot;</span><span class="p">)</span>
info <span class="o">&lt;-</span> <span class="kc">NULL</span>
info_all <span class="o">&lt;-</span> <span class="kc">NULL</span>
<span class="kr">for</span><span class="p">(</span>i <span class="kr">in</span> <span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">){</span>
info <span class="o">&lt;-</span> UnlistAndExtractInfo<span class="p">(</span>candidates<span class="p">[</span>i<span class="p">])</span>
info<span class="o">$</span>CANDIDATE <span class="o">&lt;-</span> candidates<span class="p">[</span>i<span class="p">]</span>
info_all <span class="o">&lt;-</span> <span class="kp">rbind</span><span class="p">(</span>info_all<span class="p">,</span> info<span class="p">)</span>
<span class="p">}</span>

<span class="c1"># i&#39;m going to add a few more columns...</span>
info_all <span class="o">%&lt;&gt;%</span> mutate<span class="p">(</span>carry_over_p1 <span class="o">=</span> unique_words_repeated_fromfirst<span class="o">/</span>words_unique<span class="p">,</span>
                     word_repeat <span class="o">=</span> words_total<span class="o">/</span>words_unique<span class="p">)</span></code></pre></div>

<p>Using this information to graph…</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># graph of most words spoken by debate</span>
ggplot<span class="p">(</span>order_axis<span class="p">(</span>
  <span class="kp">subset</span><span class="p">(</span>info_all<span class="p">,</span> debate <span class="o">!=</span> <span class="s">&quot;Ohio&quot;</span> <span class="o">&amp;</span> CANDIDATE <span class="o">!=</span> <span class="s">&quot;CHRISTIE&quot;</span><span class="p">),</span> <span class="c1"># christie didn&#39;t go to wisconsin</span>
    CANDIDATE<span class="p">,</span> carry_over_p1<span class="p">),</span> 
       aes<span class="p">(</span>x <span class="o">=</span> CANDIDATE_o<span class="p">,</span> 
           y <span class="o">=</span> carry_over_p1<span class="p">))</span> <span class="o">+</span> 
  geom_bar<span class="p">(</span>stat <span class="o">=</span> <span class="s">&quot;identity&quot;</span><span class="p">,</span> 
           aes<span class="p">(</span>fill <span class="o">=</span> CANDIDATE_o<span class="p">))</span> <span class="o">+</span> 
  facet_grid<span class="p">(</span>debate <span class="o">~</span><span class="m">.</span><span class="p">)</span> <span class="o">+</span> 
  theme_eem<span class="p">()</span> <span class="o">+</span>
  scale_fill_eem<span class="p">(</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span> 
  labs<span class="p">(</span>title <span class="o">=</span> <span class="s">&quot;Repetition of words by candidate&quot;</span><span class="p">,</span> 
       x <span class="o">=</span> <span class="s">&quot;Candidate&quot;</span><span class="p">,</span> 
       y <span class="o">=</span> <span class="s">&quot;% of unique words repeated from first debate&quot;</span><span class="p">)</span></code></pre></div>

<p>As the graph shows, Trump continues to lead in repetitiveness. In the latest debate, the Donald repeated 44.8% of the words he said during the first debate, followed by 38% from Kasich and 36% from Bush.</p>

<p>This is a key metric Trump has been consistently winning…</p>

<p><img src="/images/posts/reps_part2.png" alt="repetitions_trump" /></p>

<p>Again, if we plot total words versus unique words, to find the repetition of each individual word, we find Mr. Trump consistently below the trend: he says each word much more than the average candidate.</p>

<p>On the other hand, Carson and Fiorina tend to have a larger vocabulary of words.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r">ggplot<span class="p">(</span><span class="kp">subset</span><span class="p">(</span>info_all<span class="p">,</span>CANDIDATE <span class="o">!=</span> <span class="s">&quot;CHRISTIE&quot;</span><span class="p">),</span> 
       aes<span class="p">(</span>x <span class="o">=</span> words_total<span class="p">,</span> 
           y <span class="o">=</span> words_unique<span class="p">))</span> <span class="o">+</span> 
    geom_point<span class="p">(</span>aes<span class="p">(</span>colour <span class="o">=</span> CANDIDATE<span class="p">),</span> size <span class="o">=</span> <span class="m">3</span><span class="p">,</span> shape <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="o">+</span>
    stat_smooth<span class="p">()</span><span class="o">+</span>
    theme_eem<span class="p">()</span><span class="o">+</span> <span class="c1"># uses &quot;eflores/eem&quot;</span>
    scale_colour_eem<span class="p">(</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span> <span class="c1"># uses &quot;eflores/eem&quot;</span>
    labs<span class="p">(</span>title <span class="o">=</span> <span class="s">&quot;Words per Debate&quot;</span><span class="p">,</span>
         x <span class="o">=</span> <span class="s">&quot;Total Words&quot;</span><span class="p">,</span> 
         y <span class="o">=</span> <span class="s">&quot;Unique Words&quot;</span><span class="p">)</span></code></pre></div>

<p><img src="/images/posts/words_debate_2.png" alt="unique words vs words by debate" /></p>

<p>Aggregating over the whole gives us a sense of this difference much more clearly:</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># average times unique word is repeated...</span>

ggplot<span class="p">(</span>info_all<span class="p">,</span> 
       aes<span class="p">(</span>x <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>CANDIDATE<span class="p">),</span> 
           y <span class="o">=</span> word_repeat<span class="p">,</span> fill <span class="o">=</span> eem_colors<span class="p">[</span><span class="m">1</span><span class="p">]))</span> <span class="o">+</span>
  geom_boxplot<span class="p">()</span> <span class="o">+</span>
  theme_eem<span class="p">()</span><span class="o">+</span>
  labs<span class="p">(</span>title <span class="o">=</span> <span class="s">&quot;Average repetition of unique words&quot;</span><span class="p">,</span>
       x <span class="o">=</span> <span class="s">&quot;Candidate&quot;</span><span class="p">,</span> 
       y <span class="o">=</span> <span class="s">&quot;Repetitions&quot;</span><span class="p">)</span> <span class="o">+</span> theme<span class="p">(</span>legend.position <span class="o">=</span> <span class="s">&quot;none&quot;</span><span class="p">)</span></code></pre></div>

<p><img src="/images/posts/wordsxunique_2.png" alt="words per unique word" /></p>

<h2 id="speed-of-intervention">Speed of Intervention</h2>

<p>This last debate also had the effect of spreading the gap between Trump and his opponents in terms of speed in interventions. Every time he talks, he always says less words, but this was even more apparent in Las Vegas…</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># order the debates...</span>
info_all<span class="o">$</span>debate <span class="o">&lt;-</span> <span class="kp">factor</span><span class="p">(</span>info_all<span class="o">$</span>debate<span class="p">,</span> 
                          levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;Ohio&quot;</span><span class="p">,</span><span class="s">&quot;California&quot;</span><span class="p">,</span>
                                     <span class="s">&quot;Colorado&quot;</span><span class="p">,</span><span class="s">&quot;Wisconsin&quot;</span><span class="p">,</span>
                                     <span class="s">&quot;Vegas&quot;</span><span class="p">))</span>

<span class="c1"># average length of interventions</span>
ggplot<span class="p">(</span>info_all<span class="p">,</span> 
       aes<span class="p">(</span>x <span class="o">=</span> debate<span class="p">,</span> 
           y <span class="o">=</span> average_intervention<span class="p">,</span> 
           group <span class="o">=</span> CANDIDATE<span class="p">))</span> <span class="o">+</span> 
  geom_path<span class="p">(</span>aes<span class="p">(</span>colour <span class="o">=</span> CANDIDATE<span class="p">))</span> <span class="o">+</span> 
  theme_eem<span class="p">()</span> <span class="o">+</span> 
  scale_colour_eem<span class="p">(</span><span class="m">20</span><span class="p">)</span> <span class="o">+</span> 
  labs<span class="p">(</span>x <span class="o">=</span> <span class="s">&quot;Debate&quot;</span><span class="p">,</span> 
       y <span class="o">=</span> <span class="s">&quot;Words&quot;</span><span class="p">,</span> 
       title <span class="o">=</span> <span class="s">&quot;Average words per intervention&quot;</span><span class="p">)</span></code></pre></div>

<p><img src="/images/posts/intervention_debs.png" alt="words by intervention" /></p>

<p>This can also be an indication of how popular he is or how much “hits” he’s taking. When you need to counter an argument, sometimes only a few words is enough. If you do this constantly more than the others, the average is bound to go down.</p>

<h2 id="the-data">The Data</h2>

<p>As Alan Jordan suggested, i’ve left this data openly available via github, so anyone can play around with it and find a few more insights. <a href="https://github.com/Eflores89/proyectos/tree/master/data/us_debates">Here</a> is the link.</p>

<ul>
  <li>The <code>all_debates</code> data.frame contains two columns: candidate and message. This is all of the debates.</li>
  <li><code>debate_h</code> is the Ohio debate.</li>
  <li><code>debate_c</code> is the California debate.</li>
  <li><code>debate_b</code> is the Boulder debate.</li>
  <li><code>debate_w</code> is the Wisconsin debate.</li>
  <li><code>debate_v</code> is the Las Vegas debate.</li>
  <li>The <code>info_all</code> data.frame is the aggregate stats of contenders by debate. It contains word counts, unique word counts, etc.</li>
</ul>

  </div>
</article>

</body>
</html>
